# Redis Sentinel

[main resource](https://redis.io/docs/management/sentinel/)

This is Redis Replication with Heimdall.

Heimdall will regenerate all the config of the nodes,
so make sure you backup your [core](./config/heimdall/core.conf) configuration.

To reset all the configuration generated by sentinel, you can execute [reset-core-config.sh](./scripts/reset-core-config.sh).

## Run All Redis

```shell
docker compose up
```

## Stop All Redis

```shell
docker compose down
```

## Connect to Midgard via Biforst

```shell
docker exec -it bifrost redis-cli -h midgard info replication # you will see midgard-r1 and midgard-2 IPs
docker exec -it bifrost redis-cli -h heimdall -p 26379 info sentinel
```

## Simulate Midgard's Fall

### Stopping Midgard

```shell
docker compose stop midgard
# now heimdall will pick new master automatically
```